<div class="session-container">
  <!-- Connection Status Indicator -->
  <div  style="display:none"
      class="connection-status" 
       [class.connected]="connectionState() === 'connected'"
       [class.reconnecting]="connectionState() === 'reconnecting'"
       [class.error]="connectionState() === 'error'">
    <i class="bi bi-wifi" *ngIf="connectionState() === 'connected'"></i>
    <i class="bi bi-arrow-repeat rotating" *ngIf="connectionState() === 'reconnecting'"></i>
    <i class="bi bi-wifi-off" *ngIf="connectionState() === 'error'"></i>
    <span>{{ connectionState() }}</span>
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="isLoading()" class="loading-container">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3">Connecting to session...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage() && !isLoading()" class="alert alert-danger" role="alert">
    <i class="bi bi-exclamation-triangle me-2"></i>
    {{ errorMessage() }}
  </div>

  <!-- Session Content -->
  <div *ngIf="!isLoading() && !errorMessage() && session()">
    <!-- Participant List -->
    <app-participant-list 
      [participants]="participants()"
      [facilitatorId]="session()?.facilitatorId || ''">
    </app-participant-list>

    <!-- Session Header -->
    <app-session-header 
      [session]="session()"
      [participants]="participants()"
      (endSession)="onEndSession()"
      (exportSession)="onExportSession()">
    </app-session-header>

    <!-- Kanban Board -->
    <app-kanban-board 
      [topics]="topics()"
      [currentUserVotes]="currentUserVotes()"
      [currentUserId]="currentUserId"
      (addTopic)="onAddTopic()"
      (editTopic)="onEditTopic($event)"
      (deleteTopic)="onDeleteTopic($event)"
      (voteTopic)="onVoteTopic($event)"
      (moveTopic)="onMoveTopic($event)">
    </app-kanban-board>

    <!-- Session Notes -->
    <app-session-notes 
      [sessionId]="sessionId()"
      [notes]="notes()">
    </app-session-notes>
  </div>

  <!-- Add/Edit Topic Modal -->
  <app-add-topic-modal
    *ngIf="showAddTopicModal()"
    [sessionId]="sessionId()"
    [topicToEdit]="topicToEdit()"
    (topicSaved)="onTopicSaved()"
    (modalClosed)="onModalClosed()">
  </app-add-topic-modal>
</div>
